<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>marionetta.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="marionetta.html">marionetta.rb</a>
          <a class="source" href="marionetta/command_runner.html">command_runner.rb</a>
          <a class="source" href="marionetta/group.html">group.rb</a>
          <a class="source" href="marionetta/manipulators.html">manipulators.rb</a>
          <a class="source" href="marionetta/manipulators/debloyer.html">debloyer.rb</a>
          <a class="source" href="marionetta/manipulators/deployer.html">deployer.rb</a>
          <a class="source" href="marionetta/manipulators/puppet_manipulator.html">puppet_manipulator.rb</a>
          <a class="source" href="marionetta/rake_helper.html">rake_helper.rb</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>marionetta.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p><a href="http://drpheltright.github.com/marionetta/">Marionetta</a> is a ruby library for executing
commands on one or more remote machines via SSH.</p>

<p>It provides puppet provisioning without the need for a
puppet master and can also deploy your application code
(with rollbacks) via rsync. With a RakeHelper you can
integrate it into your workflow with ease.</p>

<p>Installing the gem is the best way to start using
Marionetta. You can do this from command line:</p>

<pre><code>gem install marionetta
</code></pre>

<p>Or – better yet – in your Gemfile:</p>

<pre><code>source &lsquo;http://rubygems.org&rsquo;
gem &lsquo;marionetta&rsquo;
</code></pre>

<p>Marionetta is written by <a href="http://lukemorton.co.uk">Luke Morton</a> and licensed
under the MIT license. The project is <a href="https://github.com/DrPheltRight/marionetta/">hosted on github</a>
where you can report issues and send your well thought out
pull requests.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">module</span> <span class="nn">Marionetta</span>

  <span class="no">VERSION</span> <span class="o">=</span> <span class="s1">&#39;0.4.1&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-Defining_Servers'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Defining_Servers">&#182;</a>
        </div>
        <h2>Defining Servers</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>In order to connect to servers you must define configs for
each. This method provides a default hash describing some
common settings including command binaries, default flags
and more.</p>

<p>One interesting this to note is a logger is set, pointing
to <code>STDOUT</code>.</p>

<p>Do not get too caught up in this method, it is called
elsewhere in Marionetta where you can better define your
servers. You should consult this method in order to see
the defaults.</p>

<p>Any place in this library you see a variable called
<code>server</code> you can be certain it is a server hash.</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">default_server</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="ss">:logger</span> <span class="o">=&gt;</span> <span class="no">Logger</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vg">$stdout</span><span class="p">),</span>

      <span class="ss">:ssh</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:command</span> <span class="o">=&gt;</span> <span class="s1">&#39;ssh&#39;</span><span class="p">,</span>
        <span class="ss">:flags</span>   <span class="o">=&gt;</span> <span class="o">[]</span><span class="p">,</span>
      <span class="p">},</span>

      <span class="ss">:rsync</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:command</span> <span class="o">=&gt;</span> <span class="s1">&#39;rsync&#39;</span><span class="p">,</span>
        <span class="ss">:flags</span>   <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;-azhP&#39;</span><span class="p">,</span> <span class="s1">&#39;--delete&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="p">},</span>

      <span class="ss">:archive</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:command</span> <span class="o">=&gt;</span> <span class="s1">&#39;tar&#39;</span><span class="p">,</span>
        <span class="ss">:flags</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;-zvc&#39;</span><span class="o">]</span><span class="p">,</span>
        <span class="ss">:ext</span> <span class="o">=&gt;</span> <span class="s1">&#39;tar.gz&#39;</span><span class="p">,</span>
      <span class="p">},</span>

      <span class="ss">:extract</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:command</span> <span class="o">=&gt;</span> <span class="s1">&#39;tar&#39;</span><span class="p">,</span>
        <span class="ss">:flags</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;-xv&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="p">},</span>

      <span class="ss">:puppet</span> <span class="o">=&gt;</span> <span class="p">{},</span>

      <span class="ss">:deployer</span> <span class="o">=&gt;</span> <span class="p">{},</span>

      <span class="ss">:debloyer</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;debloyer&#39;</span><span class="p">,</span>
        <span class="ss">:fpm</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="ss">:command</span> <span class="o">=&gt;</span> <span class="s1">&#39;fpm&#39;</span><span class="p">,</span>
          <span class="ss">:flags</span> <span class="o">=&gt;</span> <span class="o">[</span>
            <span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;dir&#39;</span><span class="p">,</span>
            <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;deb&#39;</span><span class="p">,</span>
          <span class="o">]</span><span class="p">,</span>
        <span class="p">},</span>
      <span class="p">},</span>
    <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
